<!DOCTYPE html>
<html>
<head>
    <title>Track Journey</title>
</head>
<body>
    <button onclick="startTracking()">Start</button>
    <button onclick="stopTracking()">Stop</button>
    <p id="output"></p>

    <script>
        let startTime, endTime, startCoords, endCoords;

        function getLocation(callback) {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(callback, 
                    error => alert("Error getting location: " + error.message), 
                    { enableHighAccuracy: true });
            } else {
                alert("Geolocation is not supported by this browser.");
            }
        }

        function startTracking() {
            getLocation(position => {
                startTime = new Date();
                startCoords = position.coords;
                document.getElementById("output").innerHTML = "Tracking started...";
            });
        }

        function stopTracking() {
            getLocation(position => {
                endTime = new Date();
                endCoords = position.coords;

                // Calculate distance using Haversine formula
                let R = 6371; // Earth radius in km
                let dLat = (endCoords.latitude - startCoords.latitude) * (Math.PI / 180);
                let dLon = (endCoords.longitude - startCoords.longitude) * (Math.PI / 180);
                let a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                        Math.cos(startCoords.latitude * (Math.PI / 180)) * 
                        Math.cos(endCoords.latitude * (Math.PI / 180)) * 
                        Math.sin(dLon / 2) * Math.sin(dLon / 2);
                let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
                let distance = R * c; // Distance in km

                let timeTaken = (endTime - startTime) / 1000 / 60; // Convert to minutes
                let avgSpeed = distance / (timeTaken / 60); // km/h

                document.getElementById("output").innerHTML = 
                    `Start: (${startCoords.latitude}, ${startCoords.longitude})<br>
                    End: (${endCoords.latitude}, ${endCoords.longitude})<br>
                    Distance: ${distance.toFixed(2)} km<br>
                    Time Taken: ${timeTaken.toFixed(2)} mins<br>
                    Average Speed: ${avgSpeed.toFixed(2)} km/h`;
            });
        }
    </script>
</body>
</html>